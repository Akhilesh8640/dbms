-- Table creation scripts
CREATE TABLE IF NOT EXISTS Employee (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(100),
    salary DECIMAL(10, 2),
    designation VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS Salary_Backup (
    emp_id INT,
    old_salary DECIMAL(10, 2),
    new_salary DECIMAL(10, 2),
    salary_difference DECIMAL(10, 2)
);

-- Trigger to record salary changes in Salary_Backup
CREATE TRIGGER record_salary_change
AFTER UPDATE ON Employee
FOR EACH ROW
BEGIN
    IF OLD.salary <> NEW.salary THEN
        INSERT INTO Salary_Backup (emp_id, old_salary, new_salary, salary_difference)
        VALUES (OLD.emp_id, OLD.salary, NEW.salary, NEW.salary - OLD.salary);
    END IF;
END;

-- Trigger to prevent deletion of CEO record
CREATE TRIGGER prevent_ceo_deletion
BEFORE DELETE ON Employee
FOR EACH ROW
BEGIN
    IF OLD.designation = 'CEO' THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Cannot delete record of an employee with the designation CEO';
    END IF;
END;
