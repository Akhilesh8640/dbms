-- 1. Trigger to ensure the salary is not decreased
CREATE OR REPLACE TRIGGER salary_check_trigger
BEFORE UPDATE OF salary ON Employee
FOR EACH ROW
BEGIN
    IF :NEW.salary < :OLD.salary THEN
        RAISE_APPLICATION_ERROR(-20001, 'Salary cannot be decreased!');
    END IF;
END;
/

-- 2. Trigger to log job title changes into job_history
CREATE OR REPLACE TRIGGER job_title_change_trigger
AFTER UPDATE OF job_title ON Employee
FOR EACH ROW
BEGIN
    -- Inserting old job details into the job_history table
    INSERT INTO job_history (emp_id, old_job_title, old_dept_id, start_date, end_date)
    VALUES (:OLD.emp_id, :OLD.job_title, :OLD.dept_id, :OLD.DoJ, SYSDATE);
END;
/
